<!doctype html>
<html>
  <head>
    <title>Create Account</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="col-md-5 mx-auto">
        <div class="card shadow">
          <div class="card-body">
            <h4 class="mb-3">Create Account</h4>

            <input
              id="name"
              class="form-control mb-2"
              placeholder="Full Name"
            />
            <input id="birthday" type="date" class="form-control mb-2" />
            <input id="email" class="form-control mb-2" placeholder="Email" />
            <input
              id="phone"
              class="form-control mb-2"
              placeholder="Mobile Number"
            />
            <input
              id="password"
              type="password"
              class="form-control mb-2"
              placeholder="Password"
            />
            <input
              id="password2"
              type="password"
              class="form-control mb-3"
              placeholder="Re-enter Password"
            />

            <button class="btn btn-dark w-100" onclick="signup()">
              Sign Up
            </button>

            <p class="mt-3 text-center">
              Already have an account?
              <a href="login.html">Login</a>
            </p>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      function signup() {
        const nameInput = document.getElementById("name");
        const birthdayInput = document.getElementById("birthday");
        const emailInput = document.getElementById("email");
        const phoneInput = document.getElementById("phone");
        const passwordInput = document.getElementById("password");
        const password2Input = document.getElementById("password2");

        // ðŸ”’ Basic validation
        if (
          !nameInput.value ||
          !birthdayInput.value ||
          !emailInput.value ||
          !phoneInput.value ||
          !passwordInput.value ||
          !password2Input.value
        ) {
          alert("Please fill in all fields.");
          return;
        }

        // basic email check
        if (!emailInput.value.includes("@")) {
          alert("Please enter a valid email address.");
          return;
        }

        if (passwordInput.value.length < 6) {
          alert("Password must be at least 6 characters.");
          return;
        }

        if (passwordInput.value !== password2Input.value) {
          alert("Passwords do not match.");
          return;
        }

        fetch("/api/customers/signup", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            name: nameInput.value,
            birthday: birthdayInput.value,
            email: emailInput.value,
            phone: phoneInput.value,
            password: passwordInput.value,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.message !== "Account created") {
              alert(data.message);
              return;
            }
            alert("ðŸŽ‰ Account created! Please login.");
            window.location.href = "login.html";
          })
          .catch(() => {
            alert("Signup failed. Please try again.");
          });
      }
    </script>
  </body>
</html>
